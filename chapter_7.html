<!DOCTYPE html>
<html lang="ru" xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link href="https://fonts.googleapis.com/css2?family=Hack&display=swap" rel="stylesheet">
    <title>Глава 7</title>
    <link rel="stylesheet" href="chapter_1.css">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200..800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/pyodide"></script>
    <script src="libs/prism.js"></script>

</head>
<div class="horizontal-accordion-wrapper">
    <div class="accordion-left">
        <button id="toggleNav" class="accordion-button-left" style="color: white; border-color: white;">☰</button>
    </div>
    <div id="sideNav" class="accordion-panel-right_2">
        <a href="#chapter7"><strong>Глава 7</strong></a>
        <a href="#chapter7-1">7.1 Пирсон и Спирмен</a>
        <a href="#chapter7-2">7.2 Рассчет корреляции</a>
    </div>
    <div class="main-content">
        <div class="logo-wrapper">
            <img src="picture/logo.svg" class="logo-top-right" alt="Логотип">
        </div>
        <section>
            <h1 style="font-size: 15px; text-align: center; color:#1e01da; ">Хэндбук. Анализ данных - базовый уровень</h1>
            <h1 style="font-size: 30px; "id="chapter7">Глава 7. Корреляция</h1>
            <h2 id="chapter7-1">7.1 Что такое корреляция?</h2>
            <p>Корреляционный анализ является важным инструментом
                для понимания взаимосвязей между различными факторами.
                Например, мы хотим оценить связь между расходами на рекламу
                ресторана и средним рейтингом или выяснить, есть ли какая-то связь
                между местоположением ресторана и размером чека; ответить на эти вопросы
                нам помогут коэффициенты корреляции</p>
            <div class="definition-card">
                <div class="definition-text">
                    <strong>Корреляция </strong> - мера статистической связи между двумя признаками.
                </div>
            </div>
            <p>Любой из коэффициентов корреляции обладает следующими свойствами:</p>
            <ul>
                <li>Корреляция меняется в диапазоне от <strong>-1 до 1</strong></li>
                <li>Чем ближе корреляция к 0, тем слабее связь между признаками.</li>
            </ul>
            <p><em>В теории мы говорим, что когда корреляция равна 0 - это отсутствие связи, но на практике корреляция от -0.1 до 0.1 также приравнивается к отсутствию связи между признаками.</em></p>
            <ul>
                <li>Чем ближе корреляция к -1 или 1, тем сильнее связь между признаками</li>
                <Li>Если корреляция отрицательная, это значит что между признаками <strong>обратная взаимосвязь</strong>: если значение одного признака А увеличивается, то значение признака В снижается (и наоборот)</Li>
                <li>Если корреляция положительная, это значит, что между признаками <strong>прямая взаимосвязь</strong>: если значение одного признака А увеличивается, то значение признака В тоже увеличивается (и наоборот)</li>
            </ul>
            <img src="picture/21.svg" width="100%" alt="Рисунок 21">
            <div class="accordion-item">
                <button class="accordion-button" style="width: 800px;">КОРРЕЛЯЦИЯ НЕ ЗНАЧИТ ВЛИЯНИЕ</button>
                <div class="accordion-content" style="padding-left: 20px;">
                    <p>Корреляция не говорит о причинно-следственных связях. На ее основе мы не можем говорить о влиянии одного признака на другой, но можем говорить о направлении изменений и о силе взаимосвязи.</p>
                    <p>Поэтому при интерпретации корреляции некорректно использовать такие фразы как: <em>"А влияет/не влияет на B" или "А является/не является причиной на B"</em></p>
                </div>
            </div>
            <p>В зависимости от того, какую взаимосвязь мы хотим рассмотреть и между какими признаками, нужно рассчитывать определенные коэффициенты корреляции. Рассмотрим два вида: корреляции Пирсона и Спирмена.</p>
            <p style="font-size: 25px;"><strong>КОРРЕЛЯЦИЯ ПИРСОНА</strong></p>
            <div class="definition-card">
                <div class="definition-text">
                    <strong>Корреляция Пирсона</strong> - это статистический показатель, используемый для измерения силы и направления <em>линейной</em> связи между двумя <em>количественными признаками</em>.
                </div>
            </div>
            <p>Значение корреляции Пирсона можно корректно интерпретировать только между двумя <strong>количественными признаками</strong>.
                Чтобы получить наиболее точную оценку коэффициента корреляции, количественные признаки должны быть <em>очищены от выбросов</em>, так как Пирсон чувствителен к экстремальным значениям; также распределение данных каждого признака должно быть <em>симметричным и унимодальным</em>.</p>
            <p>Особенность корреляции Пирсона в том, что она оценивает только степень <strong>линейной связи</strong>. То есть, чем больше данные на диаграмме рассеяния <em>похожи на прямую линию</em>,
                тем сильнее будет корреляция Пирсона, тем ближе она будет либо к -1, либо к 1:</p>
            <p>РИС 22</p>
            <p>Важнее схожести с прямой только <em>направление данных</em> на диаграмме рассеяния:</p>
            <ul>
                <li>Если данные направлены вниз (на диаграммах слева):</li>
                <ul>
                    <li>коэффициент корреляции Пирсона <em>отрицательный</em>;</li>
                    <li>между признаками <em>обратная линейная связь</em>;</li>
                    <li>при увеличении одного признака, другой будет уменьшаться (и наоборот).</li>
                </ul>
                <li>Если данные <em>направлены вверх</em> (на диаграммах справа):</li>
                <ul>
                    <li>коэффициент корреляции Пирсона <em>положительный</em>;</li>
                    <li>между признаками <em>прямая линейная связь</em>;</li>
                    <li>при увеличении одного признака, другой будет тоже расти (и наоборот)</li>
                </ul>
                <li>Если мы не можем сказать, какое у данных направление (диаграммы по центру):</li>
                <ul>
                    <li>коэффициент корреляции Пирсона <em>близок к нулю</em>;</li>
                    <li>между признаками <em>отсутствует линейная связь</em>;</li>
                    <li>между признаками может существовать <em>нелинейная связь</em>.</li>
                </ul>
            </ul>
            <p>Рассмотрим подробнее случаи, когда корреляция Пирсона между признаками равна нулю. Если точки на диаграмме рассения сложились в идеальную прямую, но она идет строго вертикально или строго горизонтально, корреляция Пирсона все равно будет равна нулю, так как при изменении одного показателя другой не будет меняться.</p>
            <p>Кроме того, данные не всегда связаны линейной связью. Корреляция Пирсона, равная нулю, говорит нам, что данные не похожи на прямую, но при этом признаки могут быть связаны какой-то другой зависимостью, как на примерах ниже:</p>
            <img src="picture/23.svg" width="100%" alt="Рисунок 23">
            <p style="font-size: 25px;"><strong>КОРРЕЛЯЦИЯ СПИРМЕНА</strong></p>
            <div class="definition-card">
                <div class="definition-text"><strong>Монотонность</strong>— это тип связи, при котором один признак только увеличивается или только уменьшается вслед за другим, без перемен направления.</div>
            </div>
            <img src="picture/24.svg" width="100%" alt="Рисунок 24">
            <p>Если Пирсон создан, чтобы "ловить" линейные зависимости, то Спирмен позволяет оценивать силу любых видов монотонных зависимостей, в том числе линейной.</p>
            <p>При интепретации корреляции Спирмена мы смотрим в первую очередь на направление данных:</p>
            <ul>
                <li>Если данные <em>направлены вниз</em> (на диаграммах слева)</li>
                <ul>
                    <li>коэффициент корреляции Спирмена <em>положительный</em>;</li>
                    <li>между признаками <em>убывающая монотонная связь</em>;</li>
                    <li>при увеличении одного признака, другой будет уменьшаться (и наоборот)</li>
                </ul>
                <li>Если данные <em>направлены вверх</em> (на диаграммах справа):</li>
                <ul>
                    <li>коэффициент корреляции Спирмена <em>положительный</em>;</li>
                    <li>между признаками <em>возрастающая монотонная связь</em>;</li>
                    <li>при увеличении одного признака, другой будет тоже расти (и наоборот).</li>
                </ul>
                <li>Если мы не можем сказать, какое у данных направление (диаграммы по центру):</li>
                <ul>
                    <li>коэффициент корреляции Спирмена <em>близок к нулю</em>;</li>
                    <li>между признаками <em>отсутствует монотонная связь</em>;</li>
                    <li>между признаками может существовать <em>немонотонная связь</em>.</li>
                </ul>
            </ul>
            <img src="picture/25.svg" width="100%" alt="Рисунок 25">
            <p>Помимо этого, само значение коэффициента корреляции Спирмена,
                указывает нам на силу монотонности. Чем ближе он к -1 или 1,
                тем ближе данные к <em>идеальной монотонной связи</em>. Если значение равно 0,
                то между признаками отсутсвует моннотонная связь. Промежуточные значения
                (например, 0.5 или -0.7) показывают <em>частичную монотонную связь</em>. Частичная
                монотонность означает, что, в целом, с увеличением одной переменной, другая
                переменная <strong>в основном</strong> увеличивается (или уменьшается), но не всегда строго и
                последовательно. Могут быть небольшие отклонения или "шумы" в данных, которые
                нарушают строгую монотонность, но при этом общая тенденция сохраняется.</p>
            <div class="scrollable-table">
                <table border="1" class="dataframe_new">
                    <thead>
                    <tr>
                        <th></th>
                        <th>Признак А</th>
                        <th>Признак В</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>Корреляция Пирсона</strong></td>
                        <td>Количественный</td>
                        <td>Количественный</td>
                    </tr>
                    <tr>
                        <td><strong>Корреляция Спирмена</strong></td>
                        <td>Порядковый</td>
                        <td>Порядковый</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Количественный</td>
                        <td>Порядковый</td>
                    </tr>
                    <tr>
                        <td></td>
                        <td>Количественный</td>
                        <td>Количественный</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <div style="height: 10px;"></div>
            <h2><strong>7.2 Как расчитать корреляцию?</strong></h2>
            <p>В прошлом разделе мы рассмотрели теоретические аспекты корреляции и то,
                как корреляцию можно оценить по диаграмме рассеяния. Теперь пришло время
                научиться рассчитывать корреляцию с использованием метода <span class="code-chip">.corr()</span> библиотеки
                Pandas. Для этого обратимся к нашим данным по ресторанам <a href="https://edu.hse.ru/mod/resource/view.php?id=1618517">restaurants.csv</a>
                :</p>
            <div class="scrollable-table">
                <table border="1" class="dataframe_new" style="width: 100%;">
                    <thead>
                    <tr>
                        <th>ПРИЗНАК</th>
                        <th>ОПИСАНИЕ</th>
                        <th>ФОРМАТ ДАННЫХ<br>(`.dtypes`)</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>name</strong></td>
                        <td>название ресторана</td>
                        <td>object</td>
                    </tr>
                    <tr>
                        <td><strong>restaurant_type</strong></td>
                        <td>тип ресторана</td>
                        <td>object</td>
                    </tr>
                    <tr>
                        <td><strong>rate</strong></td>
                        <td>рейтинг ресторана</td>
                        <td>float64</td>
                    </tr>
                    <tr>
                        <td><strong>votes</strong></td>
                        <td>количество людей, поставивших оценку ресторана</td>
                        <td>int64</td>
                    </tr>
                    <tr>
                        <td><strong>avg_receipt</strong></td>
                        <td>средний размер чека на двоих в ресторане</td>
                        <td>float64</td>
                    </tr>
                    <tr>
                        <td><strong>online_order</strong></td>
                        <td>возможность сделать онлайн заказ (1 - есть, 0 - нет)</td>
                        <td>int64</td>
                    </tr>
                    <tr>
                        <td><strong>table_booking</strong></td>
                        <td>возможность забронировать столик (1 - есть, 0 - нет)</td>
                        <td>int64</td>
                    </tr>
                    <tr>
                        <td><strong>cuisines_type</strong></td>
                        <td>кухня в ресторане</td>
                        <td>object</td>
                    </tr>
                    <tr>
                        <td><strong>area</strong></td>
                        <td>район, где расположен ресторан</td>
                        <td>object</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p>Одно <strong>наблюдение</strong> - это один <strong>ресторан</strong>.</p>
            <pre class="line-numbers"><code class="language-python">import pandas as pd
df = pd.read_csv('restaurants.csv')
df.head()</code></pre>

            <div class="scrollable-table">
                <table border="1" class="dataframe">
                    <thead>
                    <tr>
                        <th>name</th>
                        <th>restaurant_type</th>
                        <th>rate</th>
                        <th>votes</th>
                        <th>avg_receipt</th>
                        <th>online_order</th>
                        <th>table_booking</th>
                        <th>cuisines_type</th>
                        <th>area</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>#FeelTheROLL</strong></td>
                        <td>Quick Bites</td>
                        <td>3.4</td>
                        <td>7.0</td>
                        <td>200.00</td>
                        <td>0</td>
                        <td>0</td>
                        <td>Fast Food</td>
                        <td>Bellandur</td>
                    </tr>
                    <tr>
                        <td><strong>#L-81 Cafe</strong></td>
                        <td>Quick Bites</td>
                        <td>3.9</td>
                        <td>48.0</td>
                        <td>400.0</td>
                        <td>1</td>
                        <td>0</td>
                        <td>Fast Food, Beverages</td>
                        <td>Byresandra,Tavarekere,Madiwala</td>
                    </tr>
                    <tr>
                        <td><strong>#refuel</strong></td>
                        <td>Cafe</td>
                        <td>3.7</td>
                        <td>NaN</td>
                        <td>400.0</td>
                        <td>1</td>
                        <td>0</td>
                        <td>Cafe, Beverages</td>
                        <td>Bannerghatta Road</td>
                    </tr>
                    <tr>
                        <td><strong>'@ Biryani Central</strong></td>
                        <td>Casual Dining</td>
                        <td>2.7</td>
                        <td>135.0</td>
                        <td>550.0</td>
                        <td>1</td>
                        <td>0</td>
                        <td>Biryani, Mughlai, Chinese</td>
                        <td>Marathahalli</td>
                    </tr>
                    <tr>
                        <td><strong>'@99</strong></td>
                        <td>Takeaway, Delivery</td>
                        <td>3.4</td>
                        <td>37.0</td>
                        <td>200.0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>Mughlai, Biryani, Chinese, North Indian</td>
                        <td>Whitefield</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p style="font-size: 25px;"><strong>ПАРНАЯ КОРРЕЛЯЦИЯ</strong></p>
            <p>Корреляция между двумя конкретными признаками называется парной корреляцией.</p>
            <p style="font-size: 20px;"><strong>Корреляция Пирсона</strong></p>
            <p>Чтобы рассчитать корреляцию Пирсона, используем следующий синтаксис метода <span class="code-chip">.corr()</span>:</p>
            <p class="fake-code">
<span class="code-line">датафрейм['признак 1'].corr(датафрейм['признак 2'])  # Пирсон</span>
            </p>
            <p>Например, мы хотим оценить степень линейной взаимосвязи между рейтингом ресторана
                (<strong>rate</strong>) и количеством людей, поставивших оценку (<strong>votes</strong>) - тогда пишем следующий код:</p>
            <pre class="line-numbers"><code class="language-python">df['rate'].corr(df['votes'])</code></pre>
            <div class="print_result">np.float64(0.3932832917441752)</div>
            <p>С точки зрения синтаксиса неважно, какой признак мы укажем первым,
                <strong>rate</strong> или <strong>votes</strong>, значение корреляции от этого не изменится.</p>
            <p>Сила этой линейной зависимости <em>довольно слабая</em>, так как коэффициент корреляции ближе к 0,
                чем к 1. Корреляция получилась <em>положительная</em>, значит между рейтингом (<strong>rate</strong> и количеством
                людей, поставивших оценку (<strong>votes</strong>), <em>прямая линейная</em> взаимосвязь. Это значит, что если вырастет
                рейтинг (<strong>rate</strong>), то, скорее всего, вырастет количество людей, поставивших оценку ресторану (<strong>votes</strong>)</p>
            <div class="accordion-item">
                <button class="accordion-button" style="width: 800px;">Критическая оценка полученного значения</button>
                <div class="accordion-content" style="padding-left: 20px;">
                    <p>Мы не можем до конца верить полученной оценке линейной связи, так как перед этим не
                        проверили распределение признаков и не очистили данные от выбросов. При приведении
                        распределения к симметричному унимодальному виду и очистке от выбросов значение
                        корреляции Пирсона может как вырасти, так и стать еще ближе к 0. Но в любом случае,
                        эти шаги позволят узнать истинную оценку линейности, что для нас гараздо важнее.</p>
                </div>
            </div>

            <p style="font-size: 25px;"><strong>Корреляция Спирмена</strong></p>
            <p>Для рассчета корреляции Спирмена, внутрь метода <span class="code-chip">.corr()</span>,
                    нужно добавить параметр <span class="code-chip">method='spearman'</span>:</p>
            <p class="fake-code"><span class="code-line">датафрейм['признак 1'].corr(датафрейм['признак 2'], method='spearman')  # Спирмен</span></p>
            <p>Оценим уровень монотонности между рейтингом (<strong>rate</strong>) и возможностью делать онлайн заказ (<strong>online_order</strong>) в ресторане:</p>
            <pre class="line-numbers"><code class="language-python">df['rate'].corr(df['online_order'], method='spearman')</code></pre>
            <div class="print_result">np.float64(0.09041970519401271)</div>
            <p>Здесь также не важен порядок, в котором мы указали признаки: значение корреляции от этого не изменится.</p>
            <p>Корреляция Спирмена получилось крайне близкая к 0 (значение корреляции менее 0.1) - это говорит о том,
                что между признаками отсутствует монотонная связь. Значит мы не можем сказать, что если в ресторане
                появится возможность заказать онлайн (<strong>online_order</strong> станет равным 1, вместо 0), рейтинг (<strong>rate</strong>) тоже
                увеличится, или что с ростом рейтинга (<strong>rate</strong>) появится возможность сделать онлайн заказ (<strong>online_order</strong>
                станет равным 1, вместо 0)</p>
            <p style="font-size: 25px;"><strong>КОРРЕЛЯЦИОННАЯ МАТРИЦА</strong></p>
                        <p>Парная корреляция показывает зависимость только одной
                            конкретной пары признаков, но если мы хотим автоматически
                            рассчитать корреляцию между всеми признаками в данных
                            (представленных в числовом формате <span class="code-chip">int64</span> или <span class="code-chip">float64</span>),
                            то удобнее будет рассчитать корреляционную матрицу.</p>
                        <div class="definition-card">
                            <div class="definition-text">
                                <strong>Корреляционная матрица</strong> —  это таблица, показывающая корреляции (степень взаимосвязи) между всеми возможными парами признаков в наборе данных.
                            </div>
                        </div>
                        <p>Любая корреляционная матрица обладает двумя свойствами:</p>
                        <ul>
                            <li>По центральной диагонали идут единицы. Это корреляция признака с самим собой (<strong>автокорреляция</strong>); например, корреляция А с А или корреляция B c B.</li>
                            <li>Матрица симметрична относительно центральной оси. Это значит, что значения сверху полностью дублируют значения снизу. Это обусловлено тем, что корреляция A и B равна корреляции B и A</li>
                        </ul>
            <img src="picture/26.svg" width="100%" alt="Рисунок 26">
            <p>Чтобы рассчитать корреляционную матрицу по методу Пирсона, к датафрейму достаточно применить метод <span class="code-chip">.corr()</span>:</p>
            <p class="fake-code">
<span class="code-line">датафрейм.corr()  # Пирсон</span>
            </p>
            <p>Если нужна корреляционная матрица, рассчитанная по <strong>Спирмену</strong>,
                аналогично парной, внутрь добавляем параметр <span class="code-chip">method='spearman'</span>:</p>
            <p class="fake-code">
<span class="code-line">датафрейм.corr(method='spearman')  # Спирмен</span>
            </p>
            <div class="accordion-item">
                <button class="accordion-button" style="width: 800px;"><strong>Ошибка</strong> <span class="code-chip" style="color: black;">ValueError: could not convert string to float</span></button>
                <div class="accordion-content" style="padding-left: 20px;">
                    <p>Метод <span class="code-chip">.corr()</span> рассчитывает корреляционные
                        матрицы исключительно для колонок с численными
                        значениями (<span class="code-chip">int64</span>, <span class="code-chip">float64</span>), а в датарейме могут
                        быть колонки и с текстовой информацией (<span class="code-chip">object</span>).
                        Чтобы показать методу, что надо брать только численные
                        колонки, внутрь <span class="code-chip">.corr()</span> добавляем параметр
                        <span class="code-chip">numeric_only=True</span>:</p>
                    <p class="fake-code">
<span class="code-line">датафрейм.corr(numeric_only=True)  # Пирсон</span>
                    </p>
                    <p>или</p>
                    <p class="fake-code">
<span class="code-line">датафрейм.corr(method='spearman', numeric_only=True)  # Спирмен</span>
                    </p>
                </div>
            </div>
            <p></p>


            <p>Построим корреляционную матрицу, рассчитанную методом Пирсона, по нашим данным:</p>
            <pre class="line-numbers"><code class="language-python">df.corr()  # Пирсон</code></pre>
            <div class="scrollable-table">
                <table border="1" class="dataframe">
                    <thead>
                    <tr>
                        <th></th>
                        <th>rate</th>
                        <th>votes</th>
                        <th>avg_receipt</th>
                        <th>online_order</th>
                        <th>table_booking</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>rate</strong></td>
                        <td>1.000000</td>
                        <td>0.393283</td>
                        <td>0.381275</td>
                        <td>0.071802</td>
                        <td>0.407116</td>
                    </tr>
                    <tr>
                        <td><strong>votes</strong></td>
                        <td>0.393283</td>
                        <td>1.000000</td>
                        <td>0.337944</td>
                        <td>0.020665</td>
                        <td>0.369404</td>
                    </tr>
                    <tr>
                        <td><strong>avg_receipt</strong></td>
                        <td>0.381275</td>
                        <td>0.337944</td>
                        <td>1.000000</td>
                        <td>-0.132518</td>
                        <td>0.606666</td>
                    </tr>
                    <tr>
                        <td><strong>online_order</strong></td>
                        <td>0.071802</td>
                        <td>0.020665</td>
                        <td>-0.132518</td>
                        <td>1.000000</td>
                        <td>-0.033091</td>
                    </tr>
                    <tr>
                        <td><strong>table_booking</strong></td>
                        <td>0.407116</td>
                        <td>0.369404</td>
                        <td>0.606666</td>
                        <td>-0.033091</td>
                        <td>1.000000</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p>Все свойства, о которых мы говорили выше, здесь есть.
                По центральной диагонали идут единицы, это автокорреляция
                (<strong>rate</strong> c <strong>rate</strong>, <strong>votes</strong> с <strong>votes</strong> и т.д.). Матрица зеркальна
                относительно центральной диагонали: например, корреляция
                <strong>rate</strong> с <strong>votes</strong> - это то же самое, что <strong>votes</strong> с <strong>rate</strong>, и равно
                0.39.</p>
            <p>Метод <span class="code-chip">.corr()</span> автоматически посчитал корреляции между всеми признаками
                в числовом формате. Например, мы видим, что в матрице представлены
                корреляции с признаками <strong>online_order</strong> и <strong>table_booking</strong>. Они являются
                категориальными бинарными, хотя данные там и закодированы цифрами
                0 и 1. Мы помним из прошлого раздела, что корреляция Пирсона может
                быть интерпретирована только между количественными признаками,
                поэтому значения корреляции Пирсона, связанные с этими признаками,
                не стоит брать в рассчет.</p>
            <p>Чтобы убрать ненужные признаки из корреляционной
                матрицы, которая с точки зрения формата данных
                является DataFrame, передадим список только с
                количественными признаками и только по ним построим
                матрицу:</p>
            <pre class="line-numbers"><code class="language-python">df[['rate',	'votes', 'avg_receipt']].corr()</code></pre>
            <div class="scrollable-table">
                <table border="1" class="dataframe">
                    <thead>
                    <tr>
                        <th></th>
                        <th>rate</th>
                        <th>votes</th>
                        <th>avg_receipt</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>rate</strong></td>
                        <td>1.000000</td>
                        <td>0.393283</td>
                        <td>0.381275</td>
                    </tr>
                    <tr>
                        <td><strong>votes</strong></td>
                        <td>0.393283</td>
                        <td>1.000000</td>
                        <td>0.337944</td>
                    </tr>
                    <tr>
                        <td><strong>avg_receipt</strong></td>
                        <td>0.381275</td>
                        <td>0.337944</td>
                        <td>1.000000</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p>Теперь в корреляционной матрице Пирсона ничего лишнего,
                и ее можно проанализировать. Между всеми признаками
                прямая линейная зависимость, так как корреляция только
                положительная. При этом сила линейной взаимосвязи между
                признаками довольно небольшая, так как все значения
                (без учета автокорреляцции) ближе к 0, чем к 1</p>
            <p>Среди представленных признаков, самая сильная линейная
                взаимосвязь между рейтингом (<strong>rate</strong>) и количеством
                людей, поставивших оценку ресторану (<strong>votes</strong>) и равна
                она 0.39.</p>
            <p>Самая слабая корреляция (0.34) между количеством оценивших ресторан
                <strong>votes</strong> и размером чека в ресторане (<strong>avg_receipt</strong>).</p>
            <p>Теперь построим корреляционную матрицу, где значения коэффициентов будут рассчитаны по методу Спирмена:</p>
            <pre class="line-numbers"><code class="language-python">df.corr(method='spearman')  # Спирман</code></pre>
            <div class="scrollable-table">
                <table border="1" class="dataframe">
                    <thead>
                    <tr>
                        <th></th>
                        <th>rate</th>
                        <th>votes</th>
                        <th>avg_receipt</th>
                        <th>online_order</th>
                        <th>table_booking</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td><strong>rate</strong></td>
                        <td>1.000000</td>
                        <td>0.637504</td>
                        <td>0.327650</td>
                        <td>0.090420</td>
                        <td>0.403877</td>
                    </tr>
                    <tr>
                        <td><strong>votes</strong></td>
                        <td>0.637504</td>
                        <td>1.000000</td>
                        <td>0.472264</td>
                        <td>0.230633</td>
                        <td>0.430287</td>
                    </tr>
                    <tr>
                        <td><strong>avg_receipt</strong></td>
                        <td>0.327650</td>
                        <td>0.472264</td>
                        <td>1.000000</td>
                        <td>-0.008403</td>
                        <td>0.488844</td>
                    </tr>
                    <tr>
                        <td><strong>online_order</strong></td>
                        <td>0.090420</td>
                        <td>0.230633</td>
                        <td>-0.008403</td>
                        <td>1.000000</td>
                        <td>-0.033091</td>
                    </tr>
                    <tr>
                        <td><strong>table_booking</strong></td>
                        <td>0.403877</td>
                        <td>0.430287</td>
                        <td>0.488844</td>
                        <td>-0.033091</td>
                        <td>1.000000</td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <p>Корреляцию Спирмена корректно интерпретировать
                как для количественных, так для и категориальных
                признаков, поэтому извлекать определенные столбцы
                нет необходимости.</p>
            <p>Наиболее сильная монотонная связь, аналогично Пирсону,
                между рейтингом (<strong>rate</strong>) и количеством людей, поставивших
                оценку ресторану (<strong>votes</strong>) и составляет 0.63. Сила этой
                монотонной связи - умеренная.</p>
            <p>Практически нулевые значения корреляции между размером
                чека <strong>avg_receipt</strong> и <strong>online_order</strong>, <strong>online_order</strong> и <strong>table_booking</strong>,
                    <strong>online_order</strong> и <strong>rate</strong> говорят о том, что между парами этих
                признаков отсутствует монотонная связь.</p>
            <p>При этом, например, у возможности забронировать столик (<strong>table_booking</strong>) и размера чека (<strong>avg_receipt</strong>)
                наблюдается слабая возрастающая монотонная связь равная 0.49,
                - это говорит о том, что если в ресторане появится возможность
                бронировать столик (<strong>table_booking</strong> станет 1, вместо 0) размер
                чека в нем тоже может вырасти (<strong>avg_receipt</strong>), или что если цены
                в ресторане вырастут (<strong>avg_receipt</strong> станет больше), то может появиться
                возможность бронировать столик (<strong>table_booking</strong> станет 1, вместо 0).</p>
            <a href="https://edu.hse.ru/mod/quiz/view.php?id=1610941" target="_blank" rel="noopener noreferrer"><button class="check_yourself">Самоопроверка</button></a>&nbsp;<a href="https://edu.hse.ru/mod/quiz/view.php?id=1610942" target="_blank" rel="noopener noreferrer"><button class="check">Практика</button></a>&nbsp;<a href="https://edu.hse.ru/course/view.php?id=236211" target="_blank" rel="noopener noreferrer"><button class="back_to_course">Вернуться к курсу</button></a>



        </section>
        <script>
            const toggleNav = document.getElementById('toggleNav');
            const sideNav = document.getElementById('sideNav');

            toggleNav.addEventListener('click', () => {
                sideNav.classList.toggle('open');
            });
        </script>
        <script>
            document.querySelectorAll('.accordion-button').forEach(button => {
                button.addEventListener('click', () => {
                    button.classList.toggle('active');
                    const content = button.nextElementSibling;

                    if (button.classList.contains('active')) {
                        content.style.maxHeight = content.scrollHeight + 'px';
                    } else {
                        content.style.maxHeight = '0';
                    }
                });
            });
        </script>



    </div>
</div>